if(typeof Object.assign!="function"){Object.defineProperty(Object,"assign",{value:function e(t){"use strict";if(t==null){throw new TypeError("Cannot convert undefined or null to object")}var i=Object(t);for(var n=1;n<arguments.length;n++){var r=arguments[n];if(r!=null){for(var o in r){if(Object.prototype.hasOwnProperty.call(r,o)){i[o]=r[o]}}}}return i},writable:true,configurable:true})}var System;(function(e){var a={};var d={};function t(e,t,i){d[e]={deps:t,factory:i}}e.register=t;function i(e,t){a[e]=t}e.registerExternal=i;function c(e){if(e in a)return a[e];return n(e)}e.require=c;function u(e){var t=c(e);return Promise.resolve(t)}function n(e){if(!(e in d))throw new Error("Cannot resolve '"+e+"'");var t=d[e];var i={};a[e]=i;function n(e,t){i[e]=t}var r=t.factory(n,{id:e,import:u});for(var o=0;o<t.deps.length;o++){var s=t.deps[o];r.setters[o](c(s))}r.execute();return i}})(System||(System={}));var __extends=this&&this.__extends||function(){var n=function(e,t){n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i]};return n(e,t)};return function(e,t){n(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}}();var __awaiter=this&&this.__awaiter||function(o,s,a,d){return new(a||(a=Promise))(function(e,t){function i(e){try{r(d.next(e))}catch(e){t(e)}}function n(e){try{r(d["throw"](e))}catch(e){t(e)}}function r(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(i,n)}r((d=d.apply(o,s||[])).next())})};var __generator=this&&this.__generator||function(e,i){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},r,o,s,t;return t={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(t[Symbol.iterator]=function(){return this}),t;function a(t){return function(e){return d([t,e])}}function d(t){if(r)throw new TypeError("Generator is already executing.");while(n)try{if(r=1,o&&(s=t[0]&2?o["return"]:t[0]?o["throw"]||((s=o["return"])&&s.call(o),0):o.next)&&!(s=s.call(o,t[1])).done)return s;if(o=0,s)t=[t[0]&2,s.value];switch(t[0]){case 0:case 1:s=t;break;case 4:n.label++;return{value:t[1],done:false};case 5:n.label++;o=t[1];t=[0];continue;case 7:t=n.ops.pop();n.trys.pop();continue;default:if(!(s=n.trys,s=s.length>0&&s[s.length-1])&&(t[0]===6||t[0]===2)){n=0;continue}if(t[0]===3&&(!s||t[1]>s[0]&&t[1]<s[3])){n.label=t[1];break}if(t[0]===6&&n.label<s[1]){n.label=s[1];s=t;break}if(s&&n.label<s[2]){n.label=s[2];n.ops.push(t);break}if(s[2])n.ops.pop();n.trys.pop();continue}t=i.call(e,n)}catch(e){t=[6,e];o=0}finally{r=s=0}if(t[0]&5)throw t[1];return{value:t[0]?t[1]:void 0,done:true}}};System.register("utils/EventEmitter",[],function(e,t){"use strict";var i;var n=t&&t.id;return{setters:[],execute:function(){i=function(){function e(){this._listeners={}}e.prototype.addListener=function(e,t){if(!this._listeners[e]){this._listeners[e]=[]}if(this._listeners[e].indexOf(t)===-1){this._listeners[e].push(t)}};e.prototype.emit=function(t){var e=[];for(var i=1;i<arguments.length;i++){e[i-1]=arguments[i]}if(!this._listeners[t]){return}for(var n=0,r=this._listeners[t];n<r.length;n++){var o=r[n];try{o.apply(void 0,e)}catch(e){console.error("An error occurred while invoking the '"+t+"' event handler.",e)}}};e.prototype.removeListener=function(e,t){if(!this._listeners[e]){return}var i=this._listeners[e].indexOf(t);if(i!==-1){this._listeners[e].splice(i,1)}};return e}();e("default",i)}}});System.register("IBridge",[],function(e,t){"use strict";var i=t&&t.id;return{setters:[],execute:function(){}}});System.register("BaseBridge",["utils/EventEmitter"],function(e,t){"use strict";var i,n;var r=t&&t.id;return{setters:[function(e){i=e}],execute:function(){n=function(){function e(){this._eventEmitter=new i.default;this._eventResponseResolveFunctions={}}e.prototype.addEventListener=function(e,t){this._eventEmitter.addListener(e,t)};e.prototype.removeEventListener=function(e,t){this._eventEmitter.removeListener(e,t)};e.prototype.postMessageWithResponse=function(i){var n=this;var r;do{r=Math.random().toString()}while(r in this._eventResponseResolveFunctions);return new window.Promise(function(e,t){n._eventResponseResolveFunctions[r]=e;i=Object.assign({responseId:r},i);setTimeout(t,1e3);n.postMessage(i)}).then(function(e){delete n._eventResponseResolveFunctions[r];return e}).catch(function(){delete n._eventResponseResolveFunctions[r];throw new Error("The native module didn't respond to the event in time.")})};e.prototype._emit=function(e,t){this._eventEmitter.emit(e,t)};e.prototype._respondToEvent=function(e){var t=e.responseId,i=e.value;var n=this._eventResponseResolveFunctions[t];if(n){n(i)}};return e}();e("default",n)}}});System.register("utils/flattenPrototypes",[],function(e,t){"use strict";var i=t&&t.id;function n(e,t){while(t.constructor.name!=="Object"){for(var i=0,n=Object.getOwnPropertyNames(t);i<n.length;i++){var r=n[i];var o=t[r];if(typeof o==="function"&&r!=="constructor"){e[r]=o.bind(e)}}t=Object.getPrototypeOf(t)}}e("default",n);return{setters:[],execute:function(){}}});System.register("AndroidGeckoBridge",["BaseBridge","utils/flattenPrototypes"],function(e,t){"use strict";var i,n,r,o;var s=t&&t.id;return{setters:[function(e){i=e},function(e){n=e}],execute:function(){r=browser.runtime.connectNative("vuplex.browserAgent");r.onDisconnect.addListener(function(){return console.warn("WebExtension port disconnected")});r.onMessage.addListener(function(e){switch(e.type){case"vuplex.executeJavaScript":var t=e.javaScript;if(e.resultCallbackId){t=t.replace(/`/g,"\\`");t=t.replace(/\${/g,"\\${");t="vuplex.postMessage({\n          type: 'vuplex.webview.javaScriptResult',\n          id: '"+e.resultCallbackId+"',\n          value: (function() {\n            try {\n              // toString() is also needed in order for the string to be serialized correctly\n              return new String(eval(`"+t+"`)).toString();\n            } catch (error) {\n              return new String(error).toString();\n            }\n          })()\n        })"}try{window.Function('"use strict"; '+t)()}catch(e){if(e instanceof window.EvalError){console.warn("The JavaScript from IWebView.ExecuteJavaScript() could not be executed in the page's main JS context because of the page's Content Security Policy, so it will be executed in a separate context. Original error: "+e);Function('"use strict"; '+t)()}else{throw e}}break}});o=function(t){__extends(i,t);function i(){var e=t.call(this)||this;n.default(e,i.prototype);return e}i.prototype.postMessage=function(e){r.postMessage(e)};return i}(i.default);e("default",o)}}});System.register("PostMessageDomain",[],function(e,t){"use strict";var i;var n=t&&t.id;return{setters:[],execute:function(){(function(e){e["VIDEO_MANAGER_EMIT"]="vuplex.videoManagerEmit";e["VIDEO_MANAGER_INVOKE"]="vuplex.videoManagerInvoke";e["IFRAME_BRIDGE_DOWNSTREAM"]="vuplex.iframeBridgeDownstream"})(i||(i={}));e("default",i)}}});System.register("IframeBridge",["BaseBridge","PostMessageDomain"],function(e,t){"use strict";var i,n,r;var o=t&&t.id;return{setters:[function(e){i=e},function(e){n=e}],execute:function(){r=function(t){__extends(e,t);function e(){var e=t.call(this)||this;window.addEventListener("message",e._handlePostedWindowMessage.bind(e));return e}e.prototype.postMessage=function(e){};e.prototype._handlePostedWindowMessage=function(e){var t=e.data;if(!(t&&t.domain===n.default.IFRAME_BRIDGE_DOWNSTREAM)){return}var i=t.message;this._emit("message",{data:typeof i==="string"?i:JSON.stringify(i)})};return e}(i.default);e("default",r)}}});System.register("MessageType",[],function(e,t){"use strict";var i;var n=t&&t.id;return{setters:[],execute:function(){(function(e){e["ACTIVE_ELEMENT_TYPE_CHANGED"]="ACTIVE_ELEMENT_TYPE_CHANGED";e["AVAILABLE_UPGRADES_REQUEST"]="AVAILABLE_UPGRADES_REQUEST";e["INPUT_DEVICES_REQUEST"]="INPUT_DEVICES_REQUEST";e["INPUT_DEVICES_CHANGED"]="INPUT_DEVICES_CHANGED";e["INITIATE_UPGRADE"]="INITIATE_UPGRADE";e["PAGE_TRANSPARENCY_DETERMINED"]="PAGE_TRANSPARENCY_DETERMINED";e["SCALE_ISSUE_DETECTED"]="vuplex.webview.scaleIssueDetected";e["TITLE_CHANGED"]="vuplex.webview.titleChanged";e["URL_CHANGED"]="vuplex.webview.urlChanged";e["VIDEO_ADDED"]="VIDEO_ADDED";e["VIDEO_CLEAR_SOURCE"]="VIDEO_CLEAR_SOURCE";e["VIDEO_CURRENT_TIME_CHANGED"]="VIDEO_CURRENT_TIME_CHANGED";e["VIDEO_DESTROY_REQUESTED"]="VIDEO_DESTROY_REQUESTED";e["VIDEO_MUTE_CHANGED"]="VIDEO_MUTE_CHANGED";e["VIDEO_PAUSE_REQUESTED"]="VIDEO_PAUSE_REQUESTED";e["VIDEO_PLAYBACK_REQUESTED"]="VIDEO_PLAYBACK_REQUESTED";e["VIDEO_RECT_CHANGED"]="vuplex.webview.videoRectChanged";e["VIDEO_REMOVED"]="VIDEO_REMOVED";e["VIDEO_VOLUME_CHANGED"]="VIDEO_VOLUME_CHANGED";e["CLICK"]="vuplex.webview.click";e["SCROLL_AT_POINT"]="vuplex.webview.scrollAtPoint"})(i||(i={}));e("default",i)}}});System.register("InputManager",["MessageType","PostMessageDomain"],function(e,t){"use strict";var s,a,i;var n=t&&t.id;return{setters:[function(e){s=e},function(e){a=e}],execute:function(){i=function(){function f(){this._elementHoveredOver=null}f.prototype.click=function(e,t){var i=document.elementFromPoint(e,t);if(!(i instanceof HTMLElement)){return}if(i instanceof HTMLIFrameElement&&i.contentWindow){var n=i.getBoundingClientRect();var r=e-n.left;var o=t-n.top;i.contentWindow.postMessage({domain:a.default.IFRAME_BRIDGE_DOWNSTREAM,message:{type:s.default.CLICK,x:r,y:o}},"*");return}i.click();i.focus();this._triggerMouseEvent(i,"mouseover");this._triggerMouseEvent(i,"mousedown");this._triggerMouseEvent(i,"mouseup")};f.prototype.dispatchCharacter=function(e){if(e==="\n"&&document.activeElement instanceof HTMLInputElement){var t=this._getFocusedForm();if(t){t.submit()}else{var i={keyCode:13,bubbles:true};document.activeElement.dispatchEvent(new KeyboardEvent("keydown",i));document.activeElement.dispatchEvent(new KeyboardEvent("keyup",i));document.activeElement.dispatchEvent(new KeyboardEvent("keypress",i))}return}if(!f.focusedElementIsEditable){return}var n=document.activeElement;var r=this._getSelection(n),o=r.selectionStart,s=r.selectionEnd;var a=this._getTextValue(n);if(e==="\b"){var d=o===s&&o===0;if(d){return}var c=o!==s;if(c){var u=this._spliceString(a,o,s-o,"");this._setTextValue(n,u);this._setSelection(n,o,o)}else{var u=this._spliceString(a,o-1,1,"");this._setTextValue(n,u);var l=o-1;this._setSelection(n,l,l)}}else if(e==="ArrowLeft"){if(o===s){var v=Math.max(o-1,0);this._setSelection(n,v,v)}else{this._setSelection(n,o,o)}}else if(e==="ArrowRight"){if(o===s){var v=Math.min(s+1,a.length);this._setSelection(n,v,v)}else{this._setSelection(n,s,s)}}else{var u=this._spliceString(a,o,s-o,e);this._setTextValue(n,u);var l=o+1;this._setSelection(n,l,l)}};f.prototype.enableInputTypeWorkaround=function(){setInterval(this._changeActiveInputElementTypeIfNeeded.bind(this),200)};Object.defineProperty(f,"focusedElementIsEditable",{get:function(){var e=document.activeElement;return e&&(this._isInputOrTextarea(e)||e.isContentEditable)},enumerable:true,configurable:true});f.prototype.hover=function(e,t){var i=document.elementFromPoint(e,t);if(this._elementHoveredOver&&this._elementHoveredOver!==i){this._elementHoveredOver.classList.remove("hover")}this._elementHoveredOver=i;if(i){i.classList.add("hover")}};f.prototype._changeActiveInputElementTypeIfNeeded=function(){var e=document.activeElement;if(e instanceof HTMLInputElement&&(e.type==="email"||e.type==="number")){e.type="text"}};f.prototype._getFocusedForm=function(){var e=document.activeElement||null;while(e){if(e instanceof HTMLFormElement){return e}e=e.parentElement}return null};f.prototype._getTextValue=function(e){if(f._isInputOrTextarea(e)){return e.value}return e.innerText||""};f._isInputOrTextarea=function(e){return e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement};f.prototype._getSelection=function(e){if(f._isInputOrTextarea(e)){return{selectionStart:e.selectionStart||0,selectionEnd:e.selectionEnd||0}}var t=window.getSelection();if(t&&t.rangeCount){var i=t.getRangeAt(0);if(i.commonAncestorContainer.parentNode==e){return{selectionStart:i.startOffset,selectionEnd:i.endOffset}}}return{selectionStart:0,selectionEnd:0}};f.prototype._setSelection=function(e,t,i){if(f._isInputOrTextarea(e)){e.setSelectionRange(t,i);return}var n=document.createRange();var r=window.getSelection();var o=e.childNodes[0];n.setStart(o,t);n.setStart(o,i);if(r){r.removeAllRanges();r.addRange(n)}};f.prototype._setTextValue=function(e,t){if(e instanceof HTMLInputElement){Object.getOwnPropertyDescriptor(HTMLInputElement.prototype,"value").set.call(e,t)}else if(e instanceof HTMLTextAreaElement){Object.getOwnPropertyDescriptor(HTMLTextAreaElement.prototype,"value").set.call(e,t)}else{e.innerText=t}e.dispatchEvent(new Event("input",{bubbles:true}))};f.prototype._spliceString=function(e,t,i,n){return e.slice(0,t)+n+e.slice(t+Math.abs(i))};f.prototype._triggerMouseEvent=function(e,t){var i=document.createEvent("MouseEvents");i.initEvent(t,true,true);e.dispatchEvent(i)};return f}();e("default",i)}}});System.register("utils/arrayFrom",[],function(e,t){"use strict";var i=t&&t.id;function n(e){var t=[];for(var i=0;i<e.length;i++){t.push(e[i])}return t}e("default",n);return{setters:[],execute:function(){}}});System.register("showSelectDropdown",["utils/arrayFrom"],function(e,t){"use strict";var E,y;var i=t&&t.id;function I(e,t,i,n,r){var o=document.createElement("vuplex-dropdown-option");o.innerText=e.innerText;Object.assign(o.style,i);o.onclick=function(){t.value=e.value;t.dispatchEvent(new Event("change",{bubbles:true}))};if(r){o.setAttribute("selected","true");var s=function(){o.removeAttribute("selected");n.removeEventListener("mousemove",s)};n.addEventListener("mousemove",s)}return o}function n(g){return __awaiter(this,void 0,void 0,function(){function t(){if(document.body.contains(r)){document.body.removeChild(r)}n.removeEventListener("change",t)}var n,i,r,o,s,a,d,c,u,l,v,f,h,p,_,m;return __generator(this,function(e){switch(e.label){case 0:n=g.target;i=n.style.display;n.style.display="none";return[4,new Promise(function(e){return setTimeout(e,10)})];case 1:e.sent();n.style.display=i;r=document.createElement("vuplex-dropdown-container");Object.assign(r.style,{position:"fixed",top:0,right:0,bottom:0,left:0});document.body.appendChild(r);o=document.createElement("style");o.innerText="\n    vuplex-dropdown {\n      position: absolute;\n      background-color: white;\n      display: block;\n      box-shadow: 0 4px 10px rgba(0, 0, 0, .2);\n      border: 1px solid #bcbcbc;\n      z-index: 2147483648; /* max value */\n      max-height: "+y+"px;\n      overflow: scroll;\n      text-align: left;\n    }\n\n    vuplex-dropdown-option {\n      display: block;\n      padding: 6px 10px;\n      color: #1e1e1e;\n      cursor: default;\n    }\n\n    vuplex-dropdown-option:hover {\n      background-color: #1275ff;\n      color: white;\n    }\n\n    vuplex-dropdown-option[selected] {\n      background-color: #1275ff;\n      color: white;\n    }\n  ";r.appendChild(o);r.onclick=t;n.addEventListener("change",t);s=document.createElement("vuplex-dropdown");a=n.getBoundingClientRect();d=navigator.userAgent.indexOf("Firefox")===-1?0:1;s.style.left=a.left-d+"px";s.style.width=a.width+"px";s.style.top=a.top+a.height+"px";r.appendChild(s);c=window.getComputedStyle(n);u=c.font,l=c.fontSize,v=c.fontWeight;f=E.default(n.querySelectorAll("option"));h=f.find(function(e){return e.value===n.value});p={font:u,fontSize:l,fontWeight:v};f.forEach(function(e){var t=e===h;var i=I(e,n,p,s,t);s.appendChild(i);if(t){_=i}});m=s.getBoundingClientRect().height;if(m>y&&_.offsetTop>y){s.scrollTo(0,_.offsetTop)}return[2]}})})}e("default",n);return{setters:[function(e){E=e}],execute:function(){y=300}}});System.register("SelectElementManager",["utils/arrayFrom","showSelectDropdown"],function(e,t){"use strict";var o,s,a,i;var n=t&&t.id;return{setters:[function(e){o=e},function(e){s=e}],execute:function(){a="vuplex";i=function(){function e(){setInterval(this._checkIfSelectElementsWereAddedOrRemoved.bind(this),250)}e.prototype._checkIfSelectElementsWereAddedOrRemoved=function(){var e=document.querySelectorAll("select:not([multiple]):not([disabled])");var t=o.default(e);for(var i=0,n=t;i<n.length;i++){var r=n[i];if(!r.getAttributeNS(a,"managed")){r.setAttributeNS(a,"managed","true");r.addEventListener("click",s.default)}}};return e}();e("default",i)}}});System.register("Rect",[],function(e,t){"use strict";var i=t&&t.id;function n(e,t){var i=e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height;return i}e("rectsAreEqual",n);return{setters:[],execute:function(){}}});System.register("RemoteVideoController",["utils/EventEmitter","MessageType","PostMessageDomain","Rect"],function(e,t){"use strict";var i,r,o,n,s;var a=t&&t.id;return{setters:[function(e){i=e},function(e){r=e},function(e){o=e},function(e){n=e}],execute:function(){s=function(i){__extends(e,i);function e(e){var t=i.call(this)||this;t._lastIframeRect={left:0,top:0,width:0,height:0};t._lastNormalizedIframeVideoRect={left:0,top:0,width:0,height:0};t._videoRect={left:0,top:0,width:0,height:0};t._videoId=e.videoId;t._iframe=e.iframe;t._handlePostedWindowMessage=t._handlePostedWindowMessage.bind(t);window.addEventListener("message",t._handlePostedWindowMessage);t._iframeRectCheckIntervalId=setInterval(t._checkIfIframeRectChanged.bind(t),50);return t}e.prototype.complete=function(){this._proxyToIframe("complete",this._videoId)};e.prototype.destroy=function(){window.removeEventListener("message",this._handlePostedWindowMessage);clearInterval(this._iframeRectCheckIntervalId)};e.prototype.setCurrentTime=function(e){this._proxyToIframe("setCurrentTime",this._videoId,e)};e.prototype.setPlayState=function(e){this._proxyToIframe("setPlayState",this._videoId,e)};Object.defineProperty(e.prototype,"video",{get:function(){return null},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"videoId",{get:function(){return this._videoId},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"videoRect",{get:function(){return this._videoRect},enumerable:true,configurable:true});e.prototype._checkIfIframeRectChanged=function(){var e=this._iframe.getBoundingClientRect();if(n.rectsAreEqual(e,this._lastIframeRect)){return}this._lastIframeRect=e;var t=this._convertVideoRect(this._lastNormalizedIframeVideoRect);this.emit("messageEmitted",{type:r.default.VIDEO_RECT_CHANGED,videoId:this._videoId,value:{rect:t}})};e.prototype._handlePostedWindowMessage=function(e){var t=e.data;var i=e.source===this._iframe.contentWindow&&t&&t.domain===o.default.VIDEO_MANAGER_EMIT&&t.message&&t.message.videoId===this._videoId;if(!i){return}if(t.message.type===r.default.VIDEO_RECT_CHANGED){this._lastNormalizedIframeVideoRect=t.message.value.rect;var n=this._convertVideoRect(t.message.value.rect);this._videoRect=n;t.message.value.rect=n}this.emit("messageEmitted",t.message)};e.prototype._convertVideoRect=function(e){var t=this._iframe.getBoundingClientRect();var i={left:e.left*t.width,top:e.top*t.height,width:e.width*t.width,height:e.height*t.height};var n={left:t.left+i.left,top:t.top+i.top,width:i.width,height:i.height};var r={left:n.left/document.documentElement.clientWidth,top:n.top/document.documentElement.clientHeight,width:n.width/document.documentElement.clientWidth,height:n.height/document.documentElement.clientHeight};return r};e.prototype._proxyToIframe=function(e){var t=[];for(var i=1;i<arguments.length;i++){t[i-1]=arguments[i]}try{this._iframe.contentWindow.postMessage({domain:o.default.VIDEO_MANAGER_INVOKE,method:e,args:t},"*")}catch(e){console.warn("proxying a video message to an iframe failed, probably because the iframe was removed")}};return e}(i.default);e("default",s)}}});System.register("RemoteVideoControllerEmitter",["utils/EventEmitter","utils/arrayFrom","MessageType","PostMessageDomain","RemoteVideoController"],function(e,t){"use strict";var i,d,s,a,c,n;var r=t&&t.id;return{setters:[function(e){i=e},function(e){d=e},function(e){s=e},function(e){a=e},function(e){c=e}],execute:function(){n=function(t){__extends(e,t);function e(){var e=t.call(this)||this;e._trackedIframeRecords=[];window.addEventListener("message",e._handlePostedWindowMessage.bind(e));e._checkForRemovedIframes=e._checkForRemovedIframes.bind(e);setInterval(e._checkForRemovedIframes,200);return e}e.prototype._addToTrackedIframes=function(t,e){var i=this._trackedIframeRecords.find(function(e){return e.iframe===t});if(i){i.videoIds.push(e)}else{this._trackedIframeRecords.push({iframe:t,videoIds:[e]})}};e.prototype._checkForRemovedIframes=function(){var s=d.default(document.getElementsByTagName("iframe"));var e=function(e){var t=a._trackedIframeRecords[e];var i=s.find(function(e){return e===t.iframe});if(!i){for(var n=0,r=t.videoIds;n<r.length;n++){var o=r[n];a.emit("videoControllerRemoved",o)}a._trackedIframeRecords.splice(e,1)}};var a=this;for(var t=this._trackedIframeRecords.length-1;t>=0;t--){e(t)}};e.prototype._handlePostedWindowMessage=function(t){var e=t.data;if(!(e&&e.domain===a.default.VIDEO_MANAGER_EMIT&&typeof e.message==="object")){return}switch(e.message.type){case s.default.VIDEO_ADDED:{var i=e.message.videoId;var n=d.default(document.getElementsByTagName("iframe"));var r=n.find(function(e){return e.contentWindow===t.source});if(r){this._addToTrackedIframes(r,i);var o=new c.default({videoId:i,iframe:r});this.emit("videoControllerAdded",o)}break}case s.default.VIDEO_REMOVED:{this._removeFromTrackedIframes(t.source,e.message.videoId);this.emit("videoControllerRemoved",e.message.videoId);break}}};e.prototype._removeFromTrackedIframes=function(t,e){var i=this._trackedIframeRecords.find(function(e){return e.iframe.contentWindow===t});if(!i){console.warn("A remote video was removed, but its iframe is not currently tracked.");return}var n=i.videoIds.indexOf(e);if(n===-1){console.warn("A remote video was removed, but its videoId wasn't included in the list of tracked videoIds")}else{i.videoIds.splice(n,1)}};return e}(i.default);e("default",n)}}});System.register("VideoUserControls",["utils/EventEmitter"],function(e,t){"use strict";var i,s,a,d,c,n;var r=t&&t.id;return{setters:[function(e){i=e}],execute:function(){s="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMzIuMTUzIDIzMi4xNTMiIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIj48cGF0aCBkPSJNMjAzLjc5MSA5OS42MjhMNDkuMzA3IDIuMjk0QzQ0Ljc0LS40MjUgMzkuMDY5LjAyOCAzNC43ODYuMDI4IDE3LjY1NC4wMjggMTcuNzMgMTMuMjU1IDE3LjczIDE2LjYwNnYxOTguOTRjMCAyLjgzMy0uMDc1IDE2LjU3OSAxNy4wNTYgMTYuNTc5IDQuMjgzIDAgOS45NTUuNDUxIDE0LjUyMS0yLjI2N2wxNTQuNDgzLTk3LjMzM2MxMi42OC03LjU0NSAxMC40ODktMTYuNDQ5IDEwLjQ4OS0xNi40NDlzMi4xOTItOC45MDQtMTAuNDg4LTE2LjQ0OHoiIGZpbGw9IiNGRkYiIGZpbGwtcnVsZT0iZXZlbm9kZCIgY2xpcC1ydWxlPSJldmVub2RkIi8+PC9zdmc+";a="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0Ny42MDcgNDcuNjA3IiB3aWR0aD0iNTEyIiBoZWlnaHQ9IjUxMiI+PGcgZmlsbD0iI0ZGRiI+PHBhdGggZD0iTTE3Ljk5MSA0MC45NzZhNi42MzEgNi42MzEgMCAwIDEtMTMuMjYyIDBWNi42MzFhNi42MzEgNi42MzEgMCAwIDEgMTMuMjYyIDB2MzQuMzQ1ek00Mi44NzcgNDAuOTc2YTYuNjMxIDYuNjMxIDAgMCAxLTEzLjI2MiAwVjYuNjMxYTYuNjMxIDYuNjMxIDAgMCAxIDEzLjI2MiAwdjM0LjM0NXoiLz48L2c+PC9zdmc+";d="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB2aWV3Qm94PSIwIDAgNDU5IDQ1OSI+PHBhdGggZD0iTTAgMTUzdjE1M2gxMDJsMTI3LjUgMTI3LjV2LTQwOEwxMDIgMTUzSDB6bTM0NC4yNSA3Ni41YzAtNDUuOS0yNS41LTg0LjE1LTYzLjc1LTEwMnYyMDRjMzguMjUtMTcuODUgNjMuNzUtNTYuMSA2My43NS0xMDJ6TTI4MC41IDUuMXY1My41NUMzNTQuNDUgODEuNiA0MDggMTQ3Ljg5OSA0MDggMjI5LjVzLTUzLjU1IDE0Ny45LTEyNy41IDE3MC44NXY1My41NUMzODIuNSA0MzAuOTQ5IDQ1OSAzMzkuMTUgNDU5IDIyOS41UzM4Mi41IDI4LjA0OSAyODAuNSA1LjF6IiBmaWxsPSIjRkZGIi8+PC9zdmc+";c="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MTIiIGhlaWdodD0iNTEyIiB2aWV3Qm94PSIwIDAgNDYxLjU1IDQ2MS41NSI+PHBhdGggZD0iTTM0NS41MjUgMjI5LjVjMC00NS45LTI1LjUtODQuMTUtNjMuNzUtMTAydjU2LjFsNjMuNzUgNjMuNzVWMjI5LjV6bTYzLjc1IDBjMCAyMi45NS01LjEgNDUuOS0xMi43NSA2Ni4zbDM4LjI1IDM4LjI1YzE3Ljg1LTMwLjYgMjUuNS02OC44NSAyNS41LTEwNy4xIDAtMTA5LjY1LTc2LjUtMjAxLjQ1LTE3OC41LTIyNC40VjU2LjFjNzMuOTUgMjUuNSAxMjcuNSA5MS44IDEyNy41IDE3My40ek0zNC40MjUgMEwxLjI3NSAzMy4xNSAxMjEuMTI1IDE1M0gxLjI3NXYxNTNoMTAybDEyNy41IDEyNy41VjI2Mi42NWwxMDkuNjUgMTA5LjY1Yy0xNy44NTEgMTIuNzUtMzUuNyAyMi45NS01OC42NSAzMC42MDF2NTMuNTVjMzUuNy03LjY1IDY2LjMtMjIuOTUgOTQuMzUtNDUuOWw1MSA1MSAzMy4xNS0zMy4xNDktMjI5LjUtMjI5LjVMMzQuNDI1IDB6bTE5Ni4zNSAyNS41bC01My41NSA1My41NSA1My41NSA1My41NVYyNS41eiIgZmlsbD0iI0ZGRiIvPjwvc3ZnPg==";n=function(i){__extends(e,i);function e(e){var t=i.call(this)||this;t._currentTime=0;t._duration=0;t._isPlaying=false;t._muted=false;t._elements={centerPlayIcon:null,currentTime:null,duration:null,mutedIcon:null,pauseIcon:null,playIcon:null,playPauseClickTarget:null,scrubber:null,scrubberProgress:null,unmutedIcon:null};t._handleMutedOrUnmutedClick=t._handleMutedOrUnmutedClick.bind(t);t._handlePlayOrPauseClick=t._handlePlayOrPauseClick.bind(t);t._handleScrubberClick=t._handleScrubberClick.bind(t);t._createControls(e);return t}e.prototype.setCurrentTime=function(e){if(this._currentTime===e){return}this._currentTime=e;this._elements.currentTime.innerText=this._formatPlaybackTime(e);this._updateScrubberProgress()};e.prototype.setDuration=function(e){if(this._duration===e){return}this._duration=e;this._elements.duration.innerText=this._formatPlaybackTime(e);this._updateScrubberProgress()};e.prototype.setMuted=function(e){if(this._muted===e){return}this._muted=e;if(e){this._elements.mutedIcon.style.display="inline-block";this._elements.unmutedIcon.style.display="none"}else{this._elements.mutedIcon.style.display="none";this._elements.unmutedIcon.style.display="inline-block"}};e.prototype.setPlayState=function(e){if(this._isPlaying===e){return}this._isPlaying=e;if(e){this._elements.centerPlayIcon.style.display="none";this._elements.playIcon.style.display="none";this._elements.pauseIcon.style.display="inline-block"}else{this._elements.centerPlayIcon.style.display="block";this._elements.playIcon.style.display="inline-block";this._elements.pauseIcon.style.display="none"}};e.prototype._createControls=function(e){var t=document.createElement("div");t.className="vr-video-controls";Object.assign(t.style,{position:"absolute",top:0,right:0,bottom:0,left:0,pointerEvents:"all"});var i={centerPlayIcon:"",currentTime:"",duration:"",mutedIcon:"",pauseIcon:"",playIcon:"",playPauseClickTarget:"",scrubber:"",scrubberProgress:"",unmutedIcon:""};for(var n in i){i[n]=Math.random().toString()}t.innerHTML='\n      <style>\n        .vr-video-play-pause-click-target {\n          position: absolute; top: 0; right: 0; left: 0;\n          height: calc(100% - 45px);\n          display: flex;\n          justify-content: center;\n          align-items: center;\n        }\n        .vr-video-center-play-icon {\n          width: 40px;\n          cursor: pointer;\n        }\n        .vr-video-center-play-icon img {\n          width: 100%;\n        }\n        .vr-video-control-bar {\n          position: absolute; right: 0; bottom: 0; left: 0;\n          height: 40px;\n        }\n        .vr-video-scrubber {\n          height: 5px;\n          width: 95%;\n          margin: auto;\n          background-color: #a9d6d6;\n          position: relative;\n          cursor: pointer;\n        }\n        .vr-video-scrubber-progress {\n          position: absolute; top: 0; left: 0; bottom: 0;\n          width: 0%;\n          background-color: white;\n        }\n        .vr-video-bottom-controls {\n          height: 35px;\n          display: flex;\n          align-items: center;\n          width: 90%;\n          margin: auto;\n        }\n        .vr-video-control-icon {\n          height: 50%;\n          margin-right: 10px;\n          cursor: pointer;\n        }\n        .vr-video-control-icon img {\n          height: 100%;\n        }\n        .vr-video-times {\n          color: white;\n          font-family: Helvetica, Arial, sans-serif;\n          font-size: 12px;\n        }\n      </style>\n      <div class="vr-video-play-pause-click-target" id="'+i.playPauseClickTarget+'">\n        <div class="vr-video-center-play-icon" id="'+i.centerPlayIcon+'">\n          <img src="'+s+'">\n        </div>\n      </div>\n      <div class="vr-video-control-bar">\n        <div class="vr-video-scrubber" id="'+i.scrubber+'">\n          <div class="vr-video-scrubber-progress" id="'+i.scrubberProgress+'"></div>\n        </div>\n        <div class="vr-video-bottom-controls">\n          <div class="vr-video-control-icon">\n            <img src="'+s+'" id="'+i.playIcon+'">\n            <img src="'+a+'" id="'+i.pauseIcon+'" style="display: none;">\n          </div>\n          <div class="vr-video-control-icon">\n            <img src="'+d+'" id="'+i.unmutedIcon+'">\n            <img src="'+c+'" id="'+i.mutedIcon+'" style="display: none;">\n          </div>\n          <div class="vr-video-times">\n            <span id="'+i.currentTime+'">0:00</span> / <span id="'+i.duration+'">0:00</span>\n          </div>\n        </div>\n      </div>\n    ';e.appendChild(t);for(var n in i){this._elements[n]=document.getElementById(i[n])}var r={mutedIcon:this._handleMutedOrUnmutedClick,playPauseClickTarget:this._handlePlayOrPauseClick,playIcon:this._handlePlayOrPauseClick,pauseIcon:this._handlePlayOrPauseClick,scrubber:this._handleScrubberClick,unmutedIcon:this._handleMutedOrUnmutedClick};for(var o in r)this._elements[o].addEventListener("click",r[o])};e.prototype._formatPlaybackTime=function(e){if(isNaN(Math.floor(e))){return"0:00"}var t=Math.floor(e/3600).toString();var i=Math.floor(e%3600/60).toString();var n=Math.floor(e%3600%60).toString();if(n.length===1){n="0"+n}if(t!=="0"&&i.length===1){i="0"+i}var r=t==="0"?"":t+":";var o=""+r+i+":"+n;return o};e.prototype._handleMutedOrUnmutedClick=function(){var e=!this._muted;this.setMuted(e);var t=e?"mute":"unmute";this.emit(t)};e.prototype._handlePlayOrPauseClick=function(){var e=!this._isPlaying;this.setPlayState(e);var t=e?"play":"pause";this.emit(t)};e.prototype._handleScrubberClick=function(e){var t=this._elements.scrubber.getBoundingClientRect();var i=this._duration*(e.clientX-t.left)/t.width;this.setCurrentTime(i);this.emit("seek",i)};e.prototype._updateScrubberProgress=function(){var e=this._duration?this._currentTime*100/this._duration:0;this._elements.scrubberProgress.style.width=e+"%"};return e}(i.default);e("default",n)}}});System.register("VideoController",["utils/EventEmitter","MessageType","Rect","VideoUserControls"],function(e,t){"use strict";var i,r,n,o,s,a;var d=t&&t.id;return{setters:[function(e){i=e},function(e){r=e},function(e){n=e},function(e){o=e}],execute:function(){(function(e){e["NOT_TRIGGERED_YET"]="NOT_TRIGGERED_YET";e["WAITING_FOR_COMPLETION"]="WAITING_FOR_COMPLETION";e["COMPLETED"]="COMPLETED"})(s||(s={}));a=function(i){__extends(e,i);function e(e){var t=i.call(this)||this;t._currentTime=0;t._initialPlayEventState=s.NOT_TRIGGERED_YET;t._muted=false;t._videoId=Math.random().toString();t._videoRect={left:0,top:0,width:0,height:0};t._videoBackdropRect={left:0,top:0,width:0,height:0};t._volume=1;t.addListener("messageEmitted",e.messageHandler);t._video=e.video;t._handlePlayEvent=t._handlePlayEvent.bind(t);t._handleVideoEnded=t._handleVideoEnded.bind(t);t._video.addEventListener("ended",t._handleVideoEnded);t._checkIfVideoRectChanged=t._checkIfVideoRectChanged.bind(t);t._updateVideoBackdrop=t._updateVideoBackdrop.bind(t);t._patchVideoElementProperties();return t}e.prototype.complete=function(){this._handleVideoEnded();this._video.dispatchEvent(new Event("ended"))};e.prototype.destroy=function(){clearInterval(this._videoRectCheckIntervalId);this.emit("messageEmitted",{type:r.default.VIDEO_DESTROY_REQUESTED,videoId:this._videoId})};Object.defineProperty(e.prototype,"isPlaying",{get:function(){return!this._video.paused},enumerable:true,configurable:true});e.prototype.setCurrentTime=function(e){this._currentTime=e;this._video.dispatchEvent(new Event("timeupdate"));if(this._videoUserControls)this._videoUserControls.setCurrentTime(e)};e.prototype.setPlayState=function(e){if(e){if(this._initialPlayEventState===s.WAITING_FOR_COMPLETION)this._initialPlayEventState=s.COMPLETED;this._video.dispatchEvent(new Event("loadeddata"));this._video.dispatchEvent(new Event("canplay"));this._video.dispatchEvent(new Event("canplaythrough"));this._setPaused(false);this._video.dispatchEvent(Object.assign(new Event("play"),{_triggeredByJavaScript:true}));this._video.dispatchEvent(new Event("playing"))}else{this._video.pause()}};Object.defineProperty(e.prototype,"video",{get:function(){return this._video},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"videoId",{get:function(){return this._videoId},enumerable:true,configurable:true});Object.defineProperty(e.prototype,"videoRect",{get:function(){return this._videoRect},enumerable:true,configurable:true});e.prototype._checkIfVideoRectChanged=function(){var e;var t=this._currentTime&&this._currentTime.toFixed(1)===this._video.duration.toFixed(1);if(t){e={left:0,top:0,width:0,height:0}}else{var i=this._getActualVideoRect();e={left:i.left/document.documentElement.clientWidth,top:i.top/document.documentElement.clientHeight,width:i.width/document.documentElement.clientWidth,height:i.height/document.documentElement.clientHeight}}if(!n.rectsAreEqual(e,this._videoRect)){this._videoRect=e;this.emit("messageEmitted",{type:r.default.VIDEO_RECT_CHANGED,videoId:this._videoId,value:{rect:e}})}};e.prototype._getActualVideoRect=function(){var e=this._video.getBoundingClientRect();var t=e.width/e.height;var i=this._video.videoWidth;var n=this._video.videoHeight;if(!(i&&n)){return e}var r=i/n;if(r===t){return e}var o={left:e.left,top:e.top,width:e.width,height:e.height};if(r>t){o.height=o.width/r;o.top+=(e.height-o.height)/2}else{o.width=o.height*r;o.left+=(e.width-o.width)/2}return o};e.prototype._handlePlayEvent=function(e){if(e._triggeredByJavaScript){return}this._originalPause();this._video.play()};e.prototype._handleVideoEnded=function(){this._setPaused(true);this.setCurrentTime(this._video.duration)};e.prototype._patchVideoElementProperties=function(){var t=this;var e=!this._video.paused;if(!this._video.paused){this._video.pause()}this._video.setAttribute("playsinline","");this._video.setAttribute("webkit-playsinline","");this._video.addEventListener("play",this._handlePlayEvent);this._video.play=function(){if(t._initialPlayEventState===s.WAITING_FOR_COMPLETION){return}if(t._initialPlayEventState===s.NOT_TRIGGERED_YET){t._initialPlayEventState=s.WAITING_FOR_COMPLETION}var e=t._video.getAttribute("stereomode")||"none";if(e!=="top-bottom"){t._videoRectCheckIntervalId=setInterval(t._checkIfVideoRectChanged,50)}t.emit("messageEmitted",{type:r.default.VIDEO_PLAYBACK_REQUESTED,videoUrl:t._videoUrl,videoId:t._videoId,muted:t._muted,loop:t._video.getAttribute("loop")!==null,stereoMode:e})};this._originalPause=this._video.pause.bind(this._video);this._video.pause=function(){if(t._video.paused){return}t._setPaused(true);t._video.dispatchEvent(new Event("pause"));t.emit("messageEmitted",{type:r.default.VIDEO_PAUSE_REQUESTED,videoId:t._videoId})};var i=this._video.removeAttribute.bind(this._video);this._video.removeAttribute=function(e){if(e=="src"&&!t._video.paused){t.emit("messageEmitted",{type:r.default.VIDEO_CLEAR_SOURCE,videoId:t._videoId})}i(e)};Object.defineProperty(this._video,"currentTime",{configurable:true,get:function(){return t._currentTime},set:function(e){if(typeof e!=="number")throw new Error("currentTime must be a number");if(e<0)throw new Error("currentTime must be positive");t.setCurrentTime(e);t.emit("messageEmitted",{type:r.default.VIDEO_CURRENT_TIME_CHANGED,videoId:t._videoId,value:e});t._video.dispatchEvent(new Event("seeking"));t._video.dispatchEvent(new Event("seeked"))}});this._volume=this._video.volume;Object.defineProperty(this._video,"volume",{configurable:true,get:function(){return t._volume},set:function(e){if(typeof e!=="number")throw new Error("volume must be a number");if(e<0||e>1)throw new Error("Failed to set the 'volume' property on 'HTMLMediaElement': The volume provided ("+e+") is outside the range [0, 1].");t._volume=e;t._video.dispatchEvent(new Event("volumechange"));t.emit("messageEmitted",{type:r.default.VIDEO_VOLUME_CHANGED,videoId:t._videoId,value:e})}});this._muted=!!this._video.muted;Object.defineProperty(this._video,"muted",{configurable:true,get:function(){return t._muted},set:function(e){t._muted=!!e;t._video.dispatchEvent(new Event("volumechange"));t.emit("messageEmitted",{type:r.default.VIDEO_MUTE_CHANGED,videoId:t._videoId,value:t._muted});if(t._videoUserControls)t._videoUserControls.setMuted(t._muted)}});this._updateVideoBackdrop();setInterval(this._updateVideoBackdrop,200);var n=this._video.controls;if(n){this._video.controls=false}Object.defineProperty(this._video,"controls",{configurable:true,get:function(){return!!t._videoUserControls},set:function(e){if(e&&!t._videoUserControls){t._videoUserControls=new o.default(t._videoBackdrop);t._videoUserControls.addListener("play",t._video.play.bind(t._video));t._videoUserControls.addListener("pause",t._video.pause.bind(t._video));t._videoUserControls.addListener("seek",function(e){return t._video.currentTime=e});t._videoUserControls.addListener("mute",function(){return t._video.muted=true});t._videoUserControls.addListener("unmute",function(){return t._video.muted=false});t._videoUserControls.setDuration(t._video.duration);t._video.addEventListener("durationchange",function(){if(t._videoUserControls){t._videoUserControls.setDuration(t._video.duration)}});t._videoUserControls.setMuted(t._video.muted)}}});this._video.controls=n;if(e){this._video.play()}};e.prototype._setPaused=function(e){Object.defineProperty(this._video,"paused",{value:e,writable:false,configurable:true});if(this._videoUserControls)this._videoUserControls.setPlayState(!e)};e.prototype._updateVideoBackdrop=function(){if(!(this._videoBackdrop&&document.body.contains(this._videoBackdrop))){this._videoBackdrop=document.createElement("div");this._video.insertAdjacentElement("afterend",this._videoBackdrop);Object.assign(this._videoBackdrop.style,{position:"fixed",backgroundColor:"black",pointerEvents:"none"});this._videoBackdropRect={left:0,top:0,width:0,height:0}}var e=this._video.getBoundingClientRect();if(!n.rectsAreEqual(e,this._videoBackdropRect)){this._videoBackdropRect=e;Object.assign(this._videoBackdrop.style,{width:e.width+"px",height:e.height+"px",top:e.top+"px",right:e.right+"px",bottom:e.bottom+"px",left:e.left+"px"})}};Object.defineProperty(e.prototype,"_videoUrl",{get:function(){var e;if(this._video.src){e=this._video.src}else{var t=this._video.getElementsByTagName("source")[0];e=t&&t.src}if(!e){throw new Error("Video with ID "+this._videoId+" has no src attribute or source tags.")}var i=!(e.indexOf("http://")===0||e.indexOf("https://")===0||e.indexOf("file://")===0);if(i){if(e[0]==="/"){e=location.origin+e}else{var n=e.indexOf("./")===0?e.substr(2):e;var r=location.pathname.split("/").slice(0,-1).join("/");var o=r+"/"+n;e=location.origin+"/"+o}}return e},enumerable:true,configurable:true});return e}(i.default);e("default",a)}}});System.register("VideoManagerIframeBridge",["PostMessageDomain","BaseBridge"],function(e,t){"use strict";var r,i,n;var o=t&&t.id;return{setters:[function(e){r=e},function(e){i=e}],execute:function(){n=function(i){__extends(e,i);function e(e){var t=i.call(this)||this;t._videoManager=e.videoManager;window.addEventListener("message",t._handlePostedWindowMessage.bind(t));return t}e.prototype.postMessage=function(e){parent.postMessage({domain:r.default.VIDEO_MANAGER_EMIT,message:e},"*")};e.prototype._handlePostedWindowMessage=function(e){var t;var i=e.data;if(!(i&&i.domain===r.default.VIDEO_MANAGER_INVOKE)){return}var n=i.args||[];(t=this._videoManager)[i.method].apply(t,n)};return e}(i.default);e("default",n)}}});System.register("VideoManager",["utils/arrayFrom","MessageType","RemoteVideoController","RemoteVideoControllerEmitter","VideoController","VideoManagerIframeBridge"],function(e,t){"use strict";var d,o,c,i,u,n,l,r;var s=t&&t.id;return{setters:[function(e){d=e},function(e){o=e},function(e){c=e},function(e){i=e},function(e){u=e},function(e){n=e}],execute:function(){l="vrdesktop";r=function(){function e(e){this._activeVideoId=null;this._isInIframe=parent!==window;this._remoteVideoControllerEmitter=new i.default;this._videoControllers={};this._bridge=e.bridge;window.MediaSource=undefined;this._handleVideoControllerMessage=this._handleVideoControllerMessage.bind(this);if(this._isInIframe){this._bridge=new n.default({videoManager:this})}if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",this._performPostDomLoadInitialization.bind(this))}else{this._performPostDomLoadInitialization()}this._remoteVideoControllerEmitter.addListener("videoControllerAdded",this._addVideoController.bind(this));this._remoteVideoControllerEmitter.addListener("videoControllerRemoved",this._removeVideoController.bind(this));setInterval(this._checkIfVideosWereAddedToOrRemovedFromDom.bind(this),10);this._checkIfVideosWereAddedToOrRemovedFromDom()}e.prototype.complete=function(e){this._getVideo(e).complete()};e.prototype.pauseAll=function(){for(var e=0,t=this._videoControllerValues;e<t.length;e++){var i=t[e];if(i.isPlaying){try{i.setPlayState(false)}catch(e){console.log("An error occurred while pausing a video: "+e.stack)}}}};e.prototype.setCurrentTime=function(e,t){var i=this._videoControllers[e];if(i){i.setCurrentTime(t)}};e.prototype.setPlayState=function(e,t){this._getVideo(e).setPlayState(t)};e.prototype._addVideoController=function(e){e.addListener("messageEmitted",this._handleVideoControllerMessage);this._videoControllers[e.videoId]=e;if(this._isInIframe){this._bridge.postMessage({type:o.default.VIDEO_ADDED,videoId:e.videoId})}};e.prototype._checkIfVideosWereAddedToOrRemovedFromDom=function(){var t=d.default(document.getElementsByTagName("video"));for(var e=0,i=t;e<i.length;e++){var n=i[e];if(!n.getAttributeNS(l,"managed")){var r=new u.default({video:n,messageHandler:this._handleVideoControllerMessage});n.setAttributeNS(l,"managed","true");this._addVideoController(r)}}var o=this._videoControllerValues.filter(function(e){return!(e instanceof c.default)}).filter(function(e){return t.indexOf(e.video)===-1});for(var s=0,a=o;s<a.length;s++){var r=a[s];this._removeVideoController(r.videoId)}};e.prototype._getVideo=function(e){var t=this._videoControllers[e];if(t){return t}throw new Error("No video controller for videoId '"+e+"'.")};e.prototype._handleVideoControllerMessage=function(e){if(this._isInIframe){this._bridge.postMessage(e);return}var t=e.type===o.default.VIDEO_PLAYBACK_REQUESTED;var i=t&&!this._activeVideoId;var n=t&&this._activeVideoId&&e.videoId!==this._activeVideoId;if(i){this._activeVideoId=e.videoId}else if(n){this._bridge.postMessage({type:o.default.VIDEO_PAUSE_REQUESTED,videoId:this._activeVideoId});var r=this._getVideo(e.videoId);this._activeVideoId=e.videoId;this._bridge.postMessage({type:o.default.VIDEO_RECT_CHANGED,videoId:e.videoId,value:{rect:r.videoRect}})}if(this._activeVideoId===e.videoId||e.type===o.default.VIDEO_CURRENT_TIME_CHANGED){this._bridge.postMessage(e)}};e.prototype._performPostDomLoadInitialization=function(){if(!this._isInIframe){this._bridge.postMessage({type:o.default.VIDEO_RECT_CHANGED,value:{rect:{left:0,top:0,width:0,height:0}}})}};e.prototype._removeVideoController=function(e){var t=this._getVideo(e);delete this._videoControllers[e];t.removeListener("messageEmitted",this._handleVideoControllerMessage);t.destroy();if(this._isInIframe){this._bridge.postMessage({type:o.default.VIDEO_REMOVED,videoId:e})}};Object.defineProperty(e.prototype,"_videoControllerValues",{get:function(){var t=this;return Object.keys(this._videoControllers).map(function(e){return t._videoControllers[e]})},enumerable:true,configurable:true});return e}();e("default",r)}}});System.register("BrowserAgent",["utils/EventEmitter","IframeBridge","InputManager","MessageType","PostMessageDomain","SelectElementManager","VideoManager","utils/flattenPrototypes"],function(e,t){"use strict";var i,r,o,h,p,s,a,d,c,u,n;var l=t&&t.id;return{setters:[function(e){i=e},function(e){r=e},function(e){o=e},function(e){h=e},function(e){p=e},function(e){s=e},function(e){a=e},function(e){d=e}],execute:function(){(function(e){e["LOAD"]="LOAD";e["PUSH_STATE"]="PUSH_STATE";e["REPLACE_STATE"]="REPLACE_STATE";e["HASH_CHANGE"]="HASH_CHANGE"})(c||(c={}));(function(e){e["TEXT_INPUT"]="TEXT_INPUT";e["OTHER"]="OTHER"})(u||(u={}));n=function(t){__extends(n,t);function n(e){var i=t.call(this)||this;i._activeElementDuringLastBlur=null;i._activeElementType=u.OTHER;i._isInIframe=parent!==window;i._title="";i._pushState=window.history.pushState;i._replaceState=window.history.replaceState;i._handleBridgeMessage=function(e){try{var t=JSON.parse(e.data);switch(t.type){case h.default.CLICK:i.click(t.x,t.y);break;case h.default.SCROLL_AT_POINT:i.scrollAtPoint(t.deltaX,t.deltaY,t.pointerX,t.pointerY);break}}catch(e){if(!(e instanceof SyntaxError)){console.warn("An error occurred while processing a bridge message: "+e)}}};if(!(e&&e.bridge)){throw new Error("the bridge param is required")}d.default(i,n.prototype);if(i._isInIframe){i._bridge=new r.default;i._bridge.addEventListener("message",i._handleBridgeMessage)}else{i._bridge=e.bridge}if(e.enableVideoSupport){i.videoManager=new a.default(e)}i._inputManager=new o.default;i._selectElementManager=new s.default;if(e.enableInputTypeWorkaround){i._inputManager.enableInputTypeWorkaround();setInterval(i._removeAnchorTargetAttributes,1e3)}if(document.readyState==="loading"||!document.head){document.addEventListener("DOMContentLoaded",i._performPostDomLoadInitialization.bind(i))}else{i._performPostDomLoadInitialization()}if(i._isInMainFrame){i._emitUrlChange(c.LOAD);i._watchForUrlChanges()}return i}n.prototype.blur=function(){var e=document.activeElement;this._activeElementDuringLastBlur=e;if(e instanceof HTMLElement){e.blur()}};n.prototype.click=function(e,t){this._inputManager.click(e,t)};n.prototype.dispatchCharacter=function(e){this._inputManager.dispatchCharacter(e)};n.prototype.hover=function(e,t){this._inputManager.hover(e,t)};n.prototype.enableClickTest=function(){var e=this;var t=function(){e._clickTestPointerBlocker=document.createElement("div");Object.assign(e._clickTestPointerBlocker.style,{position:"fixed",top:"0",right:"0",bottom:"0",left:"0",zIndex:2147483647});e._clickTestTarget=document.createElement("div");Object.assign(e._clickTestTarget.style,{position:"absolute",top:"0",left:"0",height:"5px",width:"5px"});e._clickTestPointerBlocker.appendChild(e._clickTestTarget);document.body.appendChild(e._clickTestPointerBlocker);e._clickTestTarget.addEventListener("click",function(){e._bridge.postMessage({type:"CLICK_TEST_TARGET_HIT"});document.body.removeChild(e._clickTestPointerBlocker)});e._bridge.postMessage({type:"CLICK_TEST_TARGET_READY"})};if(document.readyState==="loading"){document.addEventListener("DOMContentLoaded",t)}else{t()}};n.prototype.focus=function(){if(this._activeElementDuringLastBlur instanceof HTMLElement){this._activeElementDuringLastBlur.focus();this._activeElementDuringLastBlur=null}};n.prototype.handleKeyboardInput=function(e){if(o.default.focusedElementIsEditable&&(e==="ArrowLeft"||e==="ArrowRight")){this.dispatchCharacter(e);return}switch(e){case"ArrowUp":window.scrollBy(0,-50);break;case"ArrowDown":window.scrollBy(0,50);break;case"ArrowLeft":window.scrollBy(-50,0);break;case"ArrowRight":window.scrollBy(50,0);break;case"cmd+ArrowUp":window.scroll(0,0);break;case"cmd+ArrowDown":window.scroll(document.body.scrollHeight,0);break;case"cmd+a":this._selectAll();break}};n.prototype.getCursorType=function(){var e=document.querySelectorAll(":hover");if(!e.length){return"default"}var t=e[e.length-1];var i=window.getComputedStyle(t);var n=i.cursor;if(n==="auto"&&t.tagName.toLowerCase()==="a"){return"pointer"}return n||"default"};n.prototype.navigateToUrl=function(e){switch(e.Type){case c.PUSH_STATE:this._pushState(null,"",e.Url);window.dispatchEvent(new Event("popstate"));break;case c.REPLACE_STATE:this._replaceState(null,"",e.Url);window.dispatchEvent(new Event("popstate"));break;case c.HASH_CHANGE:break}};n.prototype.scroll=function(e,t){window.scrollBy(e,t)};n.prototype.scrollAtPoint=function(e,t,i,n){if(e===0&&t===0){return}var r;var o=false;while(!(r===document.scrollingElement||r instanceof HTMLIFrameElement||o)){r=r?r.parentElement:document.elementFromPoint(i,n)||document.scrollingElement;if(r===document.body&&document.scrollingElement!==document.body){r=document.scrollingElement}if(!r){break}if(Math.abs(t)>Math.abs(e)){var s=false;if(t>0){var a=r.scrollHeight-(r.scrollTop+r.clientHeight);s=a>0}else{var d=r.scrollTop;s=d>0}o=s&&["scroll","auto"].indexOf(window.getComputedStyle(r).overflowY)!==-1}else{var s=false;if(e>0){var c=r.scrollWidth-(r.scrollLeft+r.clientWidth);s=c>0}else{var u=r.scrollLeft;s=u>0}o=s&&["scroll","auto"].indexOf(window.getComputedStyle(r).overflowX)!==-1}}if(r&&r instanceof HTMLIFrameElement&&r.contentWindow){var l=r.getBoundingClientRect();var v=i-l.left;var f=n-l.top;r.contentWindow.postMessage({domain:p.default.IFRAME_BRIDGE_DOWNSTREAM,message:{type:h.default.SCROLL_AT_POINT,deltaX:e,deltaY:t,pointerX:v,pointerY:f}},"*")}else if(r){r.scrollTop+=t;r.scrollLeft+=e}else{window.scrollBy(e,t)}};n.prototype._addViewportMetaTag=function(){var e=document.createElement("meta");e.setAttribute("name","viewport");e.setAttribute("content","viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=0");document.head.appendChild(e);if(document.body.clientWidth!==document.body.scrollWidth){var t=[window.innerWidth,document.documentElement.clientWidth,document.documentElement.scrollWidth];var i=t.map(function(e){return e===document.body.scrollWidth}).reduce(function(e,t){return e&&t},true);if(i){this._bridge.postMessage({type:h.default.SCALE_ISSUE_DETECTED})}}};n.prototype._determinePageTransparency=function(){var e=document.head.getElementsByTagName("meta");var t=Array.prototype.filter.call(e,function(e){return e.getAttribute("name")==="transparent"})[0];var i=!!t&&t.getAttribute("content")==="true";this._bridge.postMessage({type:h.default.PAGE_TRANSPARENCY_DETERMINED,value:i})};n.prototype._emitUrlChange=function(e){try{var t=document.URL;if(t.slice(0,6)==="about:"){return}if(t.indexOf(".pdf?file=")!==-1){return}this._bridge.postMessage({type:h.default.URL_CHANGED,urlAction:{Url:t,Title:document.title,Type:e}})}catch(e){console.error("An error occurred while handling the URL change: "+e.name+": "+e.message+"\n"+e.stack)}};n.prototype._onHashChange=function(){this._emitUrlChange(c.HASH_CHANGE)};n.prototype._onPushState=function(){this._emitUrlChange(c.PUSH_STATE)};n.prototype._onReplaceState=function(){this._emitUrlChange(c.PUSH_STATE)};n.prototype._checkActiveElementType=function(){var e=o.default.focusedElementIsEditable?u.TEXT_INPUT:u.OTHER;if(this._activeElementType!==e){this._activeElementType=e;this._bridge.postMessage({type:h.default.ACTIVE_ELEMENT_TYPE_CHANGED,value:e})}};n.prototype._checkForTitleChanges=function(){var e=document.title;if(!e||this._title===e){return}this._title=e;this._bridge.postMessage({type:h.default.TITLE_CHANGED,value:e})};Object.defineProperty(n.prototype,"_isInMainFrame",{get:function(){return parent===window},enumerable:true,configurable:true});n.prototype._performPostDomLoadInitialization=function(){this._addViewportMetaTag();if(this._isInMainFrame){setInterval(this._checkForTitleChanges.bind(this),200);setInterval(this._checkActiveElementType.bind(this),200);this._determinePageTransparency()}};n.prototype._removeAnchorTargetAttributes=function(){var e=document.querySelectorAll("a[target]");e.forEach(function(e){return e.removeAttribute("target")})};n.prototype._selectAll=function(){var e=document.activeElement;if(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement){e.select()}};n.prototype._watchForUrlChanges=function(){var n=this;var r=history.pushState;this._pushState=r.bind(history);history.pushState=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=r.apply(history,e);n._onPushState();return i};var o=history.replaceState;this._replaceState=o.bind(history);history.replaceState=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var i=o.apply(history,e);n._onReplaceState();return i};window.onhashchange=this._onHashChange.bind(this);window.addEventListener("yt-navigate-finish",this._onPushState.bind(this))};return n}(i.default);e("default",n)}}});System.register("index.android-gecko",["AndroidGeckoBridge","BrowserAgent"],function(e,t){"use strict";var i,n,r,o;var s=t&&t.id;return{setters:[function(e){i=e},function(e){n=e}],execute:function(){r=new i.default;window.wrappedJSObject.vuplex=cloneInto(r,window,{cloneFunctions:true});o=new n.default(Object.assign({bridge:r}));window.wrappedJSObject._VRDesktopBrowserAgent=cloneInto(o,window,{cloneFunctions:true});window.vuplex=r;window._VRDesktopBrowserAgent=o;window.dispatchEvent(new Event("vuplexready"))}}});System.require("index.android-gecko");
